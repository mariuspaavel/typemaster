CREATE OR REPLACE FUNCTION upload(
	asessionid INTEGER,
	content BYTEA
)
RETURNS INTEGER
LANGUAGE plpgsql
AS $$
DECLARE
aaccountid INTEGER;
amediaid INTEGER;
BEGIN
	SELECT sessions.accountid INTO aaccountid FROM sessions WHERE sessions.sessionid=asessionid;
	IF asessionid = NULL THEN
		RAISE 'session_logged_out';
	END IF;
	INSERT INTO MEDIA (owner, content) VALUES (aaccountid, content) RETURNING media.mediaid INTO amediaid;
	RETURN amediaid;
END;
$$;	
